---
import Base from "@/layouts/Base.astro";
import ArticleList from "@/components/page/ArticleList.astro";
import { sortBlogCollectionByDate } from "@/scripts/utils/collections";
import { getCollection } from "astro:content";
import Heading from "@/components/core/Heading.astro";
import config from "@/config";

const { github, email } = config.contacts;

export async function getStaticPaths() {
  const blog = sortBlogCollectionByDate(await getCollection("blog"));
  const series = await getCollection("series");

  return series.map((seriesEntry) => ({
    params: { slug: seriesEntry.data.slug },
    props: {
      description: seriesEntry.data.description,
      posts: blog.filter((post) => post.data.series === seriesEntry.id),
      name: seriesEntry.id,
    },
  }));
}

const { description, posts, name } = Astro.props;
---

<Base pageTitle="Home">
  <div>
    <div class="mt-1 mb-8">
      <nav class="mt-4 text-[12px] md:text-[14px] font-light list-none">
        <li class="inline text-gray-400"><a href="/">FRONT</a></li>
        <li class="inline pl-4 ml-4 border-l border-gray-300 text-gray-400">
          <a href="/posts/1/">POSTS</a>
        </li>
        <li class="inline font-semibold pl-4 ml-4 border-l border-gray-300">
          SERIES
        </li>
        <li class="inline pl-4 ml-4 border-l border-gray-300 text-gray-400">
          INDEX
        </li>
      </nav>
    </div>
    <div class="my-8">
      <Heading>Series.</Heading>
      <div class="mt-2 mb-4">
        <p class="text-[17.5pt] font-medium">{name}</p>
        <p class="text-[11.5pt] font-light text-gray-600">{description}</p>
      </div>
      <ArticleList articles={posts} />
    </div>
    <div class="my-8">
      <Heading>Drop.</Heading>
      <div class="font-light text-[14px]">
        <p>컴퓨테이션에 대해 이야기합니다.</p>
      </div>
      <nav class="mt-4 text-[12px] md:text-[14px] font-light list-none">
        <li class="inline text-gray-400">
          <a href={github} class="py-1.5">GITHUB</a>
        </li>
        <li class="inline pl-4 ml-4 border-l border-gray-300 text-gray-400">
          <a href={email} class="py-1.5">EMAIL</a>
        </li>
      </nav>
    </div>
  </div>
</Base>
