---
import Base from "@/layouts/Base.astro";
import Card from "@/components/page/Card.astro";
import Footer from "@/components/layout/Footer.astro";
import Heading1 from "@/components/core/Heading1.astro";
import { getCollection } from "astro:content";
import { reverse, sortBy } from "lodash-es";

const collection = await getCollection("blog");
const sorted = reverse(sortBy(collection, item => item.data.date));
const basePath = "/posts/";
---

<Base pageTitle="Home">
  <main class="text-gray-800 border-t-8 border-gray-800 pt-4">
    <Heading1><span class="font-display">Articles.</span></Heading1>
    <ul class="block my-4">
      {
        sorted.map(entry => {
          const { slug, data } = entry;
          const { title, date, summary, thumbnail } = data;

          return (
            <li class="block border-t border-gray-100">
              <a href={`${basePath}${slug}`} class="block py-4">
                <Card
                  title={title}
                  date={date}
                  summary={summary}
                  thumbnail={thumbnail}
                />
              </a>
            </li>
          );
        })
      }
    </ul>
  </main>

  <div class="mt-4">
    <Footer />
  </div>
</Base>
