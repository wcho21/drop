\documentclass{cmnp}
\usetikzlibrary{decorations.text}
\usepgfplotslibrary{units}
\usepackage{ts-plot}

\pgfplotsset{
  width=70mm,
  log basis x=2,
  xtick distance=2^2,
  xmin=2^6,
  xmax=2^18,
  use units,
  y unit=s,
  legend columns=-1,
  legend pos=north west,
  legend entries={\small Three-way, \small Two-way},
}

\begin{document}
  \begin{tikzpicture}
    \begin{scope}
      \begin{loglogaxis}[
        title style={align=center},
        title={Two-way vs. Three-way Quicksort \\(Duplicates)},
        xlabel={array size $n$},
        ylabel={elapsed time $t$},
        y unit prefix=n,
      ]
        \addplot[markplot] table [x=n,y=t]{
               n         t
             128    77.577
             256   154.105
             512   286.614
            1024   573.039
            2048  1088.416
            4096  2166.146
            8192  4262.797
           16384  8574.301
           32768 17195.630
           65536 34255.580
          131072 68518.529
        };
        \addplot[markploto] table [x=n,y=t]{
               n           t
             128    3596.703
             256    7996.378
             512   16888.299
            1024   37568.581
            2048   85892.624
            4096  170987.819
            8192  358706.528
           16384  845570.196
           32768 1833547.894
           65536 3850084.775
          131072 8452238.986
        };
        \addplot[domain=64:262144,samples=25] { 0.652 * x ^ 0.978 };
        \addplot[domain=64:242144,samples=25,draw=none,decorate,decoration={
          text along path,text align={center},raise=-5.5mm,text={|\footnotesize| {$t = 0.652 n^{0.978}\:(R^2\geq 0.999)$}}
        }] { 0.652 * x ^ 0.978 };
      \end{loglogaxis}
    \end{scope}

    \begin{scope}[xshift=80mm]
      \begin{loglogaxis}[
        title style={align=center},
        title={Two-way vs. Three-way Quicksort \\(Reversed)},
        xlabel={array size $n$},
        ylabel={elapsed time $t$},
        y unit prefix=n,
        ymin=10^3,
        ymax=10^8,
      ]
        \addplot[markplot] table [x=n,y=t]{
               n         t
             128     6388
             256    13499
             512    31126
            1024    63498
            2048   124697
            4096   309863
            8192   636871
           16384  1338809
           32768  2901987
           65536  5909609
          131072 13624630
        };
        \addplot[markploto] table [x=n,y=t]{
               n        t
             128    5057
             256   10799
             512   22832
            1024   44053
            2048  104472
            4096  187959
            8192  338931
           16384  808524
           32768 1465774
           65536 3376932
          131072 6031852
        };
        \addplot[domain=64:262144,samples=25] { 7.78 * (x * log2(x))^0.978 };
        \addplot[domain=64:242144,samples=25,draw=none,decorate,decoration={
          text along path,text align={center},raise=3.5mm,text={|\footnotesize| {$t = 7.78 (n \log_2 n)^{0.978}\:(R^2\geq 0.999)$}}
        }] { 7.78 * (x * log2(x))^0.978 };
      \end{loglogaxis}
    \end{scope}
  \end{tikzpicture}
\end{document}
